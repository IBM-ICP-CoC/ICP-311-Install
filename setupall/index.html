<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Setup on All VMs - Installing IBM Cloud Private</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Setup on All VMs";
    var mkdocs_page_input_path = "setupall.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Installing IBM Cloud Private</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../createvms/">Creating VMs</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Setup on All VMs</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#setup-on-all-machines">Setup on All Machines</a></li>
    

    <li class="toctree-l2"><a href="#install-prerequisites">Install Prerequisites</a></li>
    

    <li class="toctree-l2"><a href="#modify-the-disks">Modify the disks</a></li>
    

    <li class="toctree-l2"><a href="#install-docker">Install Docker</a></li>
    

    <li class="toctree-l2"><a href="#disable-the-firewall">Disable the firewall</a></li>
    

    <li class="toctree-l2"><a href="#rename-the-virtual-machine">Rename the virtual machine</a></li>
    

    <li class="toctree-l2"><a href="#update-the-hosts-file">Update the hosts file</a></li>
    

    <li class="toctree-l2"><a href="#setup-ssh-keys">Setup SSH keys</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#generate-the-key-on-each-node">Generate the KEY on each node</a></li>
        
            <li><a class="toctree-l3" href="#copy-the-key-to-each-of-the-other-nodes">Copy the key to each of the other nodes</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../installicp/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../customurl/">Using a custom URL</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ldap/">Installing and Configuring LDAP</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Installing IBM Cloud Private</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Setup on All VMs</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="setup-on-all-machines">Setup on All Machines</h1>
<p>To install IBM Cloud Private you first need to prepare all of your virtual machines.  These instructions are specific to the install being done, and were derived from the <a href="https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.1/installing/prep.html">Preparing your cluster for installation</a> section of the ICP Knowledge Center. They are not reflective of all the steps necessary in all situations.  </p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There are two scripts that will help you prapare your virtual machines for installation of ICP.<br />
<a href="../files/modify_fs_v2.sh">modify_fs_v2.sh</a> will prepare the disks and move the <code>/var</code> and <code>/opt</code> directories to the two additional disks provisioned when the VMs were created.<br />
<a href="../files/install_prereqs.sh">install_prereqs.sh</a> takes care of installing MOST of what you will need for the prerequisites.</p>
</div>
<h1 id="install-prerequisites">Install Prerequisites</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first time you make a secure connection to a remote machine you may see this message:</p>
<p><code>The authenticity of host '169.60.185.59 (169.60.185.59)' can't be established.
ECDSA key fingerprint is SHA256:XAs372uCWTkOqLOkXwQYuCXq21GaJFoYIuItUf0xGpc.
Are you sure you want to continue connecting (yes/no)?</code></p>
<p>Type in <code>yes</code> and the key fingerprint will be added to your <code>~/.ssh/known_hosts</code> file.</p>
</div>
<ul>
<li>Download <a href="../files/install_prereqs.sh">install_prereqs.sh</a> and use <code>scp</code> to transfer it to the virtual machine.</li>
<li>Inside of the virtual machine use this command to change the permissions: <code>chmod 777 install_prereqs.sh</code></li>
<li>Execute the script: <code>./install_prereqs.sh</code></li>
</ul>
<h1 id="modify-the-disks">Modify the disks</h1>
<p>When the virtual machine was created two additional disks were added to the configuration, but they are not yet configured inside the virtual machine.  These two disks are to be used for the <code>/opt</code> and <code>/var</code> directories.  </p>
<ul>
<li>Download <a href="../files/modify_fs_v2.sh">modify_fs_v2.sh</a> and use <code>scp</code> to transfer it to the virtual machine.</li>
<li>Inside of the virtual machine use this command to change permissions: <code>chmod 777 modify_fs_v2.sh</code></li>
<li>Execute the script: <code>./modify_fs_v2.sh 199 499</code> &lt;--- The parameters correspond to the sizes of <code>Disk 1</code> and <code>Disk 2</code> (minus 1)</li>
</ul>
<h1 id="install-docker">Install Docker</h1>
<h1 id="disable-the-firewall">Disable the firewall</h1>
<pre><code>systemctl disable firewalld
systemctl stop firewalld
</code></pre>

<h1 id="rename-the-virtual-machine">Rename the virtual machine</h1>
<p><code>hostnamectl set-hostname &lt;new name&gt;</code></p>
<h1 id="update-the-hosts-file">Update the hosts file</h1>
<p>Make sure that the <code>/etc/hosts</code> file on each virtual machine has entries for all of the other virtual machines so that they can talk to each other</p>
<h1 id="setup-ssh-keys">Setup SSH keys</h1>
<h2 id="generate-the-key-on-each-node">Generate the KEY on each node</h2>
<p><code>cd /root ;ssh-keygen -b 4096 -f /root/.ssh/id_rsa -N "" ;cat ~/.ssh/id_rsa.pub | sudo tee -a ~/.ssh/authorized_keys</code></p>
<h2 id="copy-the-key-to-each-of-the-other-nodes">Copy the key to each of the other nodes</h2>
<p><code>ssh-copy-id -i .ssh/id_rsa.pub root@dak311master</code></p>
<p><code>ssh-copy-id -i .ssh/id_rsa.pub root@dak311mgmt</code></p>
<p><code>ssh-copy-id -i .ssh/id_rsa.pub root@dak311va</code></p>
<p><code>ssh-copy-id -i .ssh/id_rsa.pub root@dak311worker1</code></p>
<p><code>ssh-copy-id -i .ssh/id_rsa.pub root@dak311worker2</code></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../installicp/" class="btn btn-neutral float-right" title="Installation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../createvms/" class="btn btn-neutral" title="Creating VMs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../createvms/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../installicp/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
